
<!DOCTYPE html>
<html>
<head>
	<title>Divvy Bikes in Chicago</title>

    <link 
        rel="stylesheet" 
        href="http://cdn.leafletjs.com/leaflet-0.7/leaflet.css"
    />
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <style>

        .info {
            padding: 6px 8px;
            font: 14px/16px Arial, Helvetica, sans-serif;
            background: white;
            background: rgba(255,255,255,0.8);
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 5px;
        }

        .info h4 {
            margin: 0 0 5px;
            color: #777;
        }

        .legend {
            text-align: left;
            line-height: 18px;
            color: #555;
        }

        .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }

        .weatherDisplay {
            text-align: left;
            line-height: 18px;
            color: #555;
        }

        .weatherDisplay i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }
        SELECT, INPUT[type="text"] {
            width: 160px;
            box-sizing: border-box;
        }
        SECTION {
            padding: 8px;
            background-color: #f0f0f0;
            overflow: auto;
        }
        SECTION > DIV {
            float: left;
            padding: 4px;
        }
        SECTION > DIV + DIV {
            width: 40px;
            
            text-align: center;
        }
    </style>

    <script
        src="http://cdn.leafletjs.com/leaflet-0.7/leaflet.js">

    </script>
            <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    
</head>
<body>

	<div id="map" style="width: 1200px; height: 600px"></div>
    <script src="WorldMap.js"></script>
    <script src="MapGeoJson.js"></script>
    <script src="fi_markers.js"></script>

	<script type="text/javascript">

        var map = null;
        var map1 = null;
        var map2 = null;
        var map3 = null;
        var map3Counter = 1;
        var polyline;

        var svg = null;

        function setMap(whichMap)
        {
            var selectedOnes = null;

            if (whichMap === 1)
            	{
            		map.removeLayer(map2);
            		map1.addTo(map);

            		selectedOnes = svg.selectAll("text");
            		selectedOnes.style("fill", "white");
            	}
            else if (whichMap === 2)
            	{
            		map.removeLayer(map1);
            		map2.addTo(map);

            		selectedOnes = svg.selectAll("text");
            		selectedOnes.style("fill", "black");	

            	}
            else if (whichMap === 3 ){

                    map3Counter = map3Counter + 1;
                    
                    if (map3Counter%2==0){

                        // control that shows community info on hover
                    var info = L.control();

                    // Updating the community div
                    info.onAdd = function (map) {
                        this._div = L.DomUtil.create('div', 'info');
                        this.update();  
                        return this._div;
                    };

                   /* info.onRemove = function (map){
                        // remove layer's DOM elements and listeners
                        map.getPanes().overlayPane.removeChild(this._div);
                        //map.off('viewreset', this._reset, this);
                    }
                    */

                    // Showing the Community Name
                    info.update = function (props) {
                       
                            this._div.innerHTML = '<h4>Community Name</h4>' +  (props ?
                            '<b>' + props.name + '</b>' + '<br>' + '<b>No. of Divvy Stations: ' 
                            + props.divvy_station + '</b>'
                            : 'Hover over a community');
                
                    };

                    // Adding to Map
                    info.addTo(map);

                    function highlightFeature(e) {
                        var layer = e.target;

                        layer.setStyle({
                        weight: 5,
                        color: '#555',
                        dashArray: '',
                        fillOpacity: 0.7
                        });

                        info.update(layer.feature.properties);
                    }


                    function getColor(d) {
                        console.log("feature.properties.divvy_station" + d);
                        return  d > 35 ? '#800026' :
                        d > 30  ? '#BD0026' :
                        d > 25  ? '#E31A1C' :
                        d > 20  ? '#FC4E2A' :
                        d > 15   ? '#FD8D3C' :
                        d > 10   ? '#FEB24C' :
                        d > 1   ? '#f2bb10' :
                        d == 0   ? '#eeeee6':
                        '#eeeee6';
                    }

                    function mapStyle(feature) {
                        return {
                            fillColor: getColor(feature.properties.divvy_station),
                            weight: 2,
                            opacity: 1,
                            color: 'white',
                            dashArray: '3',
                            fillOpacity: 0.7
                        };
                    }

                    var geojson;

                    function resetHighlight(e) {
                        geojson.resetStyle(e.target);
                        info.update();
                    }

                    function zoomToFeature(e) {
                        map.fitBounds(e.target.getBounds());
                    }

                    function onEachFeature(feature, layer) {
                        layer.on({
                            mouseover: highlightFeature,
                            mouseout: resetHighlight,
                            click: zoomToFeature
                        });
                    }

                        geojson= L.geoJson(worldMap,{
                            style: mapStyle,
                            onEachFeature: onEachFeature
                        }).addTo(map);  

                        var legend = L.control({position: 'bottomright'});

                        legend.onAdd = function (map) {

                            var div = L.DomUtil.create('div', 'info legend'),
                                legendgrades = [0,1,10, 15, 20, 25, 30, 35],
                                labels = [],from, to;

                            for (var i = 0; i < legendgrades.length; i++) {
                                from = legendgrades[i];
                                to = legendgrades[i + 1];
                                if (from !=0){
                                    labels.push(
                                    '<i style="background:' + getColor(from + 1) + '"></i> ' +
                                        (from+1) + (to ? '&ndash;' + to : '+'));
                                }
                                else {
                                     labels.push(
                                    '<i style="background:' + getColor(from + 1) + '"></i> ' +
                                        (from) + (to ? '&ndash;' + to : '+'));
                                }

                            }

                            div.innerHTML = labels.join('<br>');
                            return div;
                        };

                        legend.addTo(map);

                        // Adding Stations
                        divvyBikeLayer(); 
                    }
                    else {

                        // Removing the Community Layer
                        d3.selectAll("path").remove();

                        // removing divs
                        $("div").remove(".leaflet-top leaflet-right");
                        $("div").remove(".leaflet-top leaflet-right");
                        $("div").remove(".info.leaflet-control");

                        map.removeLayer(map3);
                        // Adding Stations
                        divvyBikeLayer(); 
                       
                    }
            }
            else if (whichMap == 4) {
                    map3Counter = map3Counter + 1;
                    if (map3Counter%2==0 )
                    {

                        divvyCalendarLineLayer();  
                        drawTrips();

                    }
                    else {

                        function clear_polyline() {
                            d3.selectAll("path").remove();
                           // console.log('inside polyline');
                            //$("div").removeClass("leaflet-clickable");
                        }
                    //clear_polyline();
                    drawTrips();
                    }
            }
        }   

    function weatherData(){
        var timeToDisplay = '8/1/13';


    }

    function drawTrips(){
        
        //map.removeLayer(polyline);
        var TimePickerValue = '07/12/2013 18:00';
        var DayToRun =  TimePickerValue.substring(0,TimePickerValue.length-6);
            //TimePickerValue = new Date(TimePickerValue);

        console.log('DayToRun'  + DayToRun);
        var AtTimeRun = new Date(TimePickerValue).getHours();

        if (AtTimeRun.length <2){
            AtTimeRun = "0"+ AtTimeRun;
        }
            
        console.log(AtTimeRun );
        console.log('drawTrips -->');


        var parseDate = ((DayToRun.substring(0,DayToRun.length-8)).length = 2 ? (DayToRun.substring(0,DayToRun.length-8)) 
                                                              : '0' + (DayToRun.substring(0,DayToRun.length-8)) )
                        + '_' 
                        + DayToRun.substring(DayToRun.length-7,DayToRun.length-5) 
                        + '_'
                        +DayToRun.substring(DayToRun.length-4,DayToRun.length);
        


        var csvFile = "./App/json/Map/Trips_data/trips_data_by_"+ parseDate + ".csv";

        console.log('parseDate' + parseDate);

        //var timeSelectedToRun = document.getElementById('TimePicker').value;
        var time;
         var filteredtime ;
         //console.log('asds' + AtTimeRun.substring(0,2));
        d3.csv(csvFile,function(unFilterData){

                    console.log('Inside csv file');
                    // Filtering data for a particular time
                  var data = unFilterData.filter(function(d,i){

                             time = new Date(d.starttime).getHours();
                             if (time.length <2){
                                time = "0" + time;
                             }

                             //console.log(time.length ==2);
                            //console.log('time'  + time);
                           
                            //console.log('inside filter');

                           /* if (time[time.length-5]== null){
                                time[time.length-5] = "0";
                            }
                            */



                            //console.log('AtTimeRun--> '  + AtTimeRun + 'filteredtime' + filteredtime);
                            //console.log('filteredtime' + filteredtime);
                        if (AtTimeRun==time)
                        {
                            //console.log(d);
                            console.log('filteredtime' + filteredtime);
                            return d;
                        }

                    });

                    
                  //  var linesFeatureLayer = L.geoJson(myLines);
//linesFeatureLayer.addTo(map);


                    
                      //  polyline = L.polyline([[ data.from_station_long,data.from_station_latt],
                        //                                [ data.to_station_long,data.to_station_latt]]).addTo(map);

                  /*  var data = unFilterData.filter(function(d,i){

                    if (d["community"] == myCommunityName )
                    {
                        return d;
                    }

                    });
*/
                    // Filtering data according to the station list selected by the user
                   /* for (var i =0; i<data.length; i++){

                        while ()
                        if (+data[i]['from_station_name'] == ){

                        }
                    }
                    */
                    var selected = [];
                    var firstSelected = [];



                    var e1 = document.getElementById("Chicago_Data");
                    var e2 = e1.options[e1.selectedIndex].text;
                    if (e2 =="Communities"){
                        $("#leftValues2").each(function(){
                        selected = $(this).val();     
                    })
                    }
                    else {
                         $("#leftValues1").each(function(){
                        selected = $(this).val();     
                        })

                    }


                   // console.log(selected[0][1]);
                    
                    var fromHash = {},
                    toData = {},
                    to_station_name,
                    value =[];

                    var j= 1;
                    //console.log("before hashmap");
                    console.log('dataLength : ' + data.length);
                    //console.log(selected);
                  /*  for (j= 0; j<data.length; j++){

                            var fromKey = data[j]['from_station_name'] ;
                            console.log(fromKey);
                            
                            var toArray = fromHash[fromKey];

                            if (!toArray ){
                                toArray = [];
                            }
                            
                            var toKey = data[j]['to_station_name'] ;

                           // var toArray ;
                            
                            var toData = new Object();
                                toData = [toKey,data[j]['trip_id']];
                                toArray.push(toData);
                            
                            fromHash[fromKey] = toArray;

                            //console.log(fromHash['Wilton Ave & Diversey Pkwy'] );
                    }
                    */
                    //console.log(fromHash['Wilton Ave & Diversey Pkwy'] );
                    
                    //console.log("after hashmap");
                    //console.log("selected Length"selected.length);


                    //console.log('XXXXXX' + e2);

                    if (e2 =="Communities"){
                        for (var i = 0; i< selected.length; i ++){
                            if (data[j]['from_community'] == selected[i]){

                            }
                        }
                        map.removeLayer(polyline);
                        // console.log('XXXXXX' + e2);
                        for (var i = 0; i< selected.length; i ++){
                            
                            for (var j = 0 ; j <data.length; j++){
                            //console.log('from_station_name');
                                //console.log('conss ' + fromHash[selected[j]]);
                                if (data[j]['from_community'] == selected[i]){
                                    //console.log('from_community');
                                    polyline = L.polyline([[ 
                                                                        //+data[parseInt(fromHash[name][i][1])]['from_station_latt'],
                                                                        +data[j]['from_station_latt'],
                                                                        //+data[parseInt(fromHash[name][i][1])]['from_station_long']
                                                                        +data[j]['from_station_long']
                                                                        ],
                                                                       [ 
                                                                       //+data[parseInt(fromHash[name][i][1])]['to_station_latt'],
                                                                       +data[j]['to_station_latt'],
                                                                        //+data[parseInt(fromHash[name][i][1])]['to_station_long']
                                                                        +data[j]['to_station_long']
                                                                       ]
                                                                    ],{
                                                color: 'red',
                                                weight: 2,
                                                opacity: .7,
                                               // dashArray: '20,15',
                                                lineJoin: 'round'
                                            });
//.addTo(map);                      

                                    map.addLayer(polyline);

                                }
                            }
                        }
                    }
                    else {
                        for (var i = 0; i< selected.length; i ++){
                            
                            for (var j = 0 ; j <data.length; j++){
                            //console.log('from_station_name');
                                //console.log('conss ' + fromHash[selected[j]]);
                                if (data[j]['from_station_name'] == selected[i]){
                                    //console.log('from_station_name');
                                    polyline = L.polyline([[ 
                                                                        //+data[parseInt(fromHash[name][i][1])]['from_station_latt'],
                                                                        +data[j]['from_station_latt'],
                                                                        //+data[parseInt(fromHash[name][i][1])]['from_station_long']
                                                                        +data[j]['from_station_long']
                                                                        ],
                                                                       [ 
                                                                       //+data[parseInt(fromHash[name][i][1])]['to_station_latt'],
                                                                       +data[j]['to_station_latt'],
                                                                        //+data[parseInt(fromHash[name][i][1])]['to_station_long']
                                                                        +data[j]['to_station_long']
                                                                       ]
                                                                    ],{
                                                color: 'red',
                                                weight: 2,
                                                opacity: .7,
                                               // dashArray: '20,15',
                                                lineJoin: 'round'
                                            }).addTo(map); 

                                }
                            }
                        }
                    }
                    //console.log("last log");
                    

                });
    }

    function divvyCalendarLineLayer(){
            map.addLayer(map3);


            dealWithData();
            //var numBeats = 3;
            var currentBeats = 0;

            function dealWithData()
            {       
                console.log("inside dealWithData");
                d3.json("ChicagoDivvy.json", function(collection) {

                    var e1 = document.getElementById("Chicago_Data");
                    var e2 = e1.options[e1.selectedIndex].text;

                    if (e2 =="Communities"){
                        $("#leftValues2").each(function(){
                            selected = $(this).val();     
                        })
                    }
                    else {
                        $("#leftValues1").each(function(){
                            selected = $(this).val();     
                        })

                    }
                    
                    collection.stationBeanList.forEach(function(d) {
                        if (d.latitude && d.longitude)
                        {
                            if (isNaN(d.latitude))
                                console.log("latitude is not a number");
                            if (isNaN(d.longitude))
                                console.log("longitude is not a number");

                                d.LatLng = new L.LatLng(+d.latitude, +d.longitude);
                                d.color = "green";
                            }
                            else
                            {
                                d.LatLng = new L.LatLng(0,0);
                            }   
                        });



                        var feature = g.selectAll("circle")
                        .data(collection.stationBeanList)
                        .enter()
                        .append("svg:circle")
                        .style("stroke","white")  
                        .style("stroke-width", "2")
                        .style("opacity", 1.0)
                        .style("fill", "green")
                        .attr("r", 10)
                        .on("click",function(){
                            circleCounter = circleCounter + 1;
                            console.log("circleCounter" + circleCounter);
                            if(circleCounter%2!=0){
                               d3.select(this).attr("class", "selected")
                               .style("fill","red"); 
                            }
                            else{
                                d3.select(this).attr("class", "unselected")
                                .style("fill","green"); 
                            }
                            
                        });

               /*     var feature2 = g.selectAll("text")
                    .data(collection.stationBeanList)
                    .enter()
                    .append("svg:text")
                    .style("fill", "white")
                    .style("stroke", function (d) { return d.color; })
                    .style("stroke-width", "1")
                    .style("font-size", "30px")
                    .style("font-family", "Arial")
                    .style("text-anchor", "start")
                    .style("font-weight","bold")
                    .text(function (d)
                    {
                    return d.stationName; 
                    });
                    ;
                    */
                        map.on("viewreset", update);
                        update();

                        function update() {
                                    feature.attr("transform", 
                                    function(d) { 
                                    return "translate("+ 
                                    map.latLngToLayerPoint(d.LatLng).x +","+ 
                                    map.latLngToLayerPoint(d.LatLng).y +")";
                                }
                            );

                           /* feature2.attr("transform", 
                                function(d) { 
                                    return "translate("+ 
                                    (map.latLngToLayerPoint(d.LatLng).x+20.0) +","+ 
                                    (map.latLngToLayerPoint(d.LatLng).y+5.0) +")";
                                }
                            );
    */

                        }       
                })  
            }
        }
    function divvyBikeLayer(){
                map.addLayer(map3);



                function getColor(d) {
                    console.log("feature.properties.popularity" + d);

                    d = parseInt(d);

                    return  d > 300 ? '#5402f6' :
                            d > 250  ? '#9171d0' :
                            d > 200  ? '#f20cf4' :
                            d > 150  ? '#0ccbf4' :
                            d > 100   ? '#FD8D3C' :
                            d > 50   ? '#FEB24C' :
                            d > 11   ? '#54f602' :
                            d == 0   ? '#dcf602':
                            '#dcf602';
                }

                function getRadius(d) {

                }
             
                var greenMarkerOptions = {
                        radius: 10,
                        fillColor: "green",
                        color: "#000",
                        weight: 1,
                        opacity: 1,
                        fillOpacity: 0.8
                    };


                L.geoJson(MapGeoJson, {
                    pointToLayer: function (feature, latlng) {
                        
                        var content = "<table border=1><tr><th colspan=2 bgcolor=#99CCFF font-size><b>" + feature.properties.station_name + "</th></tr><tr><th colspan=2><img src='DivvyLogo.jpg' height=80 width=200></th></tr><tr><td>Popularity Rank" + "</td><td>"+ feature.properties.popularity +"</td></tr><tr><td> Community Name </td><td>" +  feature.properties.community + "</td></tr><tr><td>Overall Inflow</td><td>"+ feature.properties.inflow+"</td></tr><tr><td>Overall Outflow</td><td>"+ feature.properties.outflow+"</td></tr></table>";
                        var popup = L.popup().setContent(content);

                        var greenMarkerOptions = {
                            radius: 10,
                            fillColor: getColor(feature.properties.popularity),
                            color: "#000",
                            weight: 1,
                            opacity: 1,
                            fillOpacity: 0.8
                        };
                        

                        var marker = L.circleMarker(latlng, greenMarkerOptions);

                       /* if (feature.properties.popularity < 11){
                            marker = L.circleMarker(latlng, redMarkerOptions);
                        }

                        else if (feature.properties.popularity < 50){
                             marker = L.circleMarker(latlng, greenMarkerOptions);
                        }
                        */
                        //var marker = L.marker(latlng, {icon : greenIcon});

                            marker.bindPopup(popup);
                        return marker;              
                    }
                }).addTo(map);
    }

    var mapURL2 = 'http://{s}.www.toolserver.org/tiles/bw-mapnik/{z}/{x}/{y}.png';
    var mapCopyright2 = 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community';

    var mapURL3 = 'http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}';
    var mapCopyright3 = '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>';


    var mapURL1 = 'http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}';
    var mapCopyright1 = 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community';

    //var mapURL2 = 'http://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}';
    //var mapCopyright2 = 'Tiles &copy; Esri &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC';

    map1 = L.tileLayer(mapURL1, {attribution: mapCopyright1});
    map2 = L.tileLayer(mapURL2, {attribution: mapCopyright2});
    map3 = L.tileLayer(mapURL3, {attribution: mapCopyright3});


    map = L.map('map', {layers: [map1,map2,map3], zoomControl: true}).setView([41.869910, -87.65], 16);

	//map = L.map('map', {zoomControl: false}).setView([41.869910, -87.65], 16);

	// mapLink = L.tileLayer(mapURL1, {attribution: mapCopyright1}).addTo(map);


	/* Initialize the SVG layer */
	map._initPathRoot();  

	/* We simply pick up the SVG from the map object */
	svg = d3.select(map.getPanes().overlayPane).select("svg");

	var g = svg.append("g");

	var parseDate = d3.time.format("%Y-%m-%dT%H:%M:%S").parse;

	var today = new Date();
    var circleCounter = 0;

	var bigCollection = {};

	//var numBeats = 3;
	var currentBeats = 0;
</script>
        <div id="buttons" style="width:100%; height:10%; text-align: center; background: #fff">
            <input name="updateButton1" 
                     type="button" 
                    value="Zoom In" 
                    onclick="map.zoomIn()" />
            <input name="updateButton2" 
                     type="button" 
                    value="Zoom Out" 
                    onclick="map.zoomOut()" />
            <input name="updateButton3" 
                     type="button" 
                    value="Map View" 
                    onclick="setMap(2)" />
            <input name="updateButton4" 
                     type="button" 
                    value="Aerial View" 
                    onclick="setMap(1)" />
            <input name="updateButton4" 
                     type="button" 
                    value="Refresh" 
                    onclick="refreshData()" />
            <input name = "updateButton5" 
                    type = "Button" 
                    value = "Community View" 
                    onclick= "setMap(3)"/> 
            <input name = "calendarView" 
                    type = "Button"
                    value = "Trips View"
                    onclick = "setMap(4)"
                    />

            <input type="datetime" name= "timeControl"/>
            <section class="container">
               
                <div>
                                        <select id="Chicago_Data" onchange="updateDropDownTarget()">
                        <option id="Stations" class="Stations" size= "4" >Stations</option>
                        <option id="Communities" class="Communities" size ="4">Communities</option>
                    </select>
                        <select id="leftValues1" name="Stations" size="5" multiple></select>
                        <select id="leftValues2" name="Communities" size="5" multiple></select>
                    
                        <input type="button" id="btnLeft" value="&lt;&lt;" />
                        <input type="button" id="btnRight" value="&gt;&gt;" />
                        <!--<input type="button" value="Clear options" onclick="$('#leftValues option').remove()" /> -->

                    

                    <select id="rightValues1" name="Stations" size="4" multiple>
                        <option>Wilton Ave & Diversey Pkwy</option>
                        <option>Morgan St & 18th St</option>
                        <option>Racine Ave & 18th St</option>
                        <option>Wood St & North Ave</option>
                        <option>Wood St & Division St</option>
                        <option>Loomis St & Taylor St</option>
                        <option>Sheffield Ave & Kingsbury St</option>
                        <option>Aberdeen St & Jackson Blvd</option>
                        <option>May St & Taylor St</option>
                        <option>Orleans St & Elm St</option>
                        <option>Fairbanks Ct & Grand Ave</option>
                        <option>Michigan Ave & Pearson St</option>
                        <option>McClurg Ct & Illinois St</option>
                        <option>Larrabee St & North Ave</option>
                        <option>Larrabee St & Menomonee St</option>
                        <option>Noble St & Milwaukee Ave</option>
                        <option>Ashland Ave & Augusta Blvd</option>
                        <option>Franklin St & Chicago Ave</option>
                        <option>Racine Ave & Congress Pkwy</option>
                        <option>State St & Van Buren St</option>
                        <option>Cannon Dr & Fullerton Ave</option>
                        <option>Streeter Dr & Illinois St</option>
                        <option>Franklin St & Jackson Blvd</option>
                        <option>Dearborn St & Adams St</option>
                        <option>Wabash Ave & Cermak Rd</option>
                        <option>Michigan Ave & Washington St</option>
                        <option>State St & Randolph St</option>
                        <option>Michigan Ave & Congress Pkwy</option>
                        <option>Wells St & Walton St</option>
                        <option>State St & Kinzie St</option>
                        <option>Larrabee St & Kingsbury St</option>
                        <option>Dearborn St & Monroe St</option>
                        <option>Clark St & Congress Pkwy</option>
                        <option>Clark St & Randolph St</option>
                        <option>Michigan Ave & Lake St</option>
                        <option>Wells St & Erie St</option>
                        <option>Ogden Ave & Chicago Ave</option>
                        <option>Halsted St & James M Rochford St</option>
                        <option>Desplaines St & Kinzie St</option>
                        <option>Clinton St & Roosevelt Rd</option>
                        <option>Ashland Ave & Armitage Ave</option>
                        <option>Wabash Ave & Roosevelt Rd</option>
                        <option>Dayton St & North Ave</option>
                        <option>Wood St & Milwaukee Ave</option>
                        <option>McCormick Place</option>
                        <option>Clinton St & Lake St</option>
                        <option>Sheffield Ave & Fullerton Ave</option>
                        <option>Clinton St & Tilden St</option>
                        <option>Damen Ave & Pierce Ave</option>
                        <option>Morgan St & Lake St</option>
                        <option>State St & 16th St</option>
                        <option>Jefferson St & Monroe St</option>
                        <option>Kingsbury St & Erie St</option>
                        <option>Canal St & Jackson Blvd</option>
                        <option>Lake Shore Dr & Monroe St</option>
                        <option>Clinton St & Madison St</option>
                        <option>Aberdeen St & Madison St</option>
                        <option>Daley Center Plaza</option>
                        <option>Green St & Milwaukee Ave</option>
                        <option>Michigan Ave & Oak St</option>
                        <option>Eckhart Park</option>
                        <option>Racine Ave & Fullerton Ave</option>
                        <option>May St & Randolph St</option>
                        <option>Millennium Park</option>
                        <option>Clinton St & Washington Blvd</option>
                        <option>Carpenter St & Huron St </option>
                        <option>Sheffield Ave & Willow St</option>
                        <option>Lincoln Ave & Armitage Ave</option>
                        <option>Museum Campus</option>
                        <option>LaSalle St & Washington St</option>
                        <option>Lake Shore Dr & Ohio St</option>
                        <option>Orleans St & Merchandise Mart Plaza</option>
                        <option>State St & Pearson St</option>
                        <option>Halsted St & Polk St</option>
                        <option>900 W Harrison</option>
                        <option>State St & Erie St</option>
                        <option>Sedgwick St & Huron St</option>
                        <option>Green St & Randolph St</option>
                        <option>Bissell St & Armitage Ave</option>
                        <option>Sheffield Ave & Addison St</option>
                        <option>Sheffield Ave & Wellington Ave</option>
                        <option>Western Ave & Winnebago Ave</option>
                        <option>Wilton Ave & Belmont Ave</option>
                        <option>Sedgwick St & North Ave</option>
                        <option>Ashland Ave & Lake St</option>
                        <option>Wentworth Ave & Archer Ave</option>
                        <option>Blackstone Ave & Hyde Park Blvd</option>
                        <option>Congress Pkwy & Ogden Ave</option>
                        <option>California Ave & Milwaukee Ave</option>
                        <option>Damen Ave & Cullerton St</option>
                        <option>Clark St & North Ave</option>
                        <option>Lincoln Ave & Fullerton Ave</option>
                        <option>Damen Ave & Chicago Ave</option>
                        <option>Blue Island Ave & 18th St</option>
                        <option>Damen Ave & Division St</option>
                        <option>Lincoln Ave & Belmont Ave</option>
                        <option>Wentworth Ave & 24th St</option>
                        <option>Peoria St & Jackson Blvd</option>
                        <option>Halsted St & 21st St</option>
                        <option>Racine Ave & 13th St</option>
                        <option>Morgan Ave & 14th Pl</option>
                        <option>Clybourn Ave & Division St</option>
                        <option>Dearborn Pkwy & Delaware Pl</option>
                        <option>Clark St & Lincoln Ave  </option>
                        <option>Sedgwick St & Webster Ave</option>
                        <option>Larrabee St & Webster Ave</option>
                        <option>Loomis St & Jackson Blvd</option>
                        <option>Indiana Ave & 26th St</option>
                        <option>State St & 33rd St</option>
                        <option>Calumet Ave & 33rd St</option>
                        <option>Fort Dearborn Dr & 31st St</option>
                        <option>Lincoln Ave & Diversey Pkwy</option>
                        <option>Southport Ave & Wellington Ave</option>
                        <option>Southport Ave & Belmont Ave</option>
                        <option>Clark St & Wellington Ave</option>
                        <option>Lake Shore Dr & Wellington Ave</option>
                        <option>Milwaukee Ave & Wabansia Ave</option>
                        <option>Claremont Ave & Hirsch St</option>
                        <option>Campbell Ave & North Ave</option>
                        <option>Damen Ave & Wellington Ave</option>
                        <option>Paulina St & Diversey Pkwy</option>
                        <option>Franklin St & Lake St</option>
                        <option>Clark St & Waveland Ave</option>
                        <option>Ashland Ave & Wrightwood Ave</option>
                        <option>Damen Ave & Coulter St</option>
                        <option>Michigan Ave & 14th St</option>
                        <option>Canal St & Harrison St</option>
                        <option>Clinton St & 18th St</option>
                        <option>May St & Cullerton St</option>
                        <option>Mies van der Rohe Way & Chicago Ave</option>
                        <option>Canal St & Madison St</option>
                        <option>Wells St & Polk St</option>
                        <option>Clark St & Elm St</option>
                        <option>Theater on the Lake</option>
                        <option>State St & 19th St</option>
                        <option>Martin Luther King Dr & Oakwood Blvd</option>
                        <option>LaSalle St & Illinois St</option>
                        <option>Damen Ave & Augusta Blvd</option>
                        <option>State St & 35th St</option>
                        <option>Stave St & Armitage Ave</option>
                        <option>Ogden Ave & Race Ave</option>
                        <option>Greenview Ave & Fullerton Ave</option>
                        <option>Southport Ave & Wrightwood Ave</option>
                        <option>Canal St & Monroe St</option>
                        <option>Canal St & Adams St</option>
                        <option>State St & 29th St</option>
                        <option>State St & Wacker Dr</option>
                        <option>Columbus Dr & Randolph St</option>
                        <option>Cityfront Plaza & N Water St</option>
                        <option>Michigan Ave & Madison St</option>
                        <option>Halsted St & Madison St</option>
                        <option>Wabash Ave & Grand Ave</option>
                        <option>King Dr & 47th St</option>
                        <option>Indiana Ave & 40th St</option>
                        <option>Halsted St & 18th St</option>
                        <option>Western Ave & 21st St</option>
                        <option>Prairie Ave & Garfield Blvd</option>
                        <option>Paulina St & 18th St</option>
                        <option>Halsted St & Archer Ave</option>
                        <option>Emerald Ave & 28th St</option>
                        <option>Ashland Ave & 21st St</option>
                        <option>Normal Ave & Archer Ave</option>
                        <option>Ashland Ave & Division St</option>
                        <option>St Clair St & Erie St</option>
                        <option>Wells St & Ohio St</option>
                        <option>Leavitt St & North Ave</option>
                        <option>Damen Ave & Grand Ave</option>
                        <option>Damen Ave & Madison St</option>
                        <option>California Ave & Division St</option>
                        <option>May St & Fulton St</option>
                        <option>Wells St & 19th St</option>
                        <option>Damen Ave & Cortland Ave</option>
                        <option>Hampden Ct & Diversey Pkwy</option>
                        <option>Milwaukee Ave & Rockwell St</option>
                        <option>Clifton Ave & Armitage Ave</option>
                        <option>Halsted St & Willow St</option>
                        <option>Halsted St & Dickens Ave</option>
                        <option>Racine Ave & Belmont Ave</option>
                        <option>Southport Ave & Waveland Ave</option>
                        <option>Damen Ave & Melrose Ave</option>
                        <option>Southport Ave & Roscoe St</option>
                        <option>Lincoln Ave & Roscoe St</option>
                        <option>Sheridan Rd & Montrose Ave</option>
                        <option>Pine Grove Ave & Addison St</option>
                        <option>Sangamon St & Washington Blvd</option>
                        <option>Clark St & Montrose Ave</option>
                        <option>Sedgwick St & Schiller St</option>
                        <option>Martin Luther King Dr & 29th St</option>
                        <option>Ravenswood Ave & Montrose Ave</option>
                        <option>Western Ave & Leland Ave</option>
                        <option>Sheridan Rd & Irving Park Rd</option>
                        <option>Morgan St & Polk St</option>
                        <option>Damen Ave & Leland Ave</option>
                        <option>Lincoln Ave & Leavitt St</option>
                        <option>Ravenswood Ave & Irving Park Rd</option>
                        <option>Clarendon Ave & Junior Ter</option>
                        <option>Ashland Ave & Belle Plaine Ave</option>
                        <option>Shore Drive & 55th St</option>
                        <option>Woodlawn Ave & 55th St</option>
                        <option>Montrose Harbor</option>
                        <option>Ashland Ave & Wellington Ave</option>
                        <option>Clarendon Ave & Leland Ave</option>
                        <option>Greenwood Ave & 47th St</option>
                        <option>Clifton Ave & Lawrence Ave</option>
                        <option>Pine Grove Ave & Irving Park Rd</option>
                        <option>Indiana Ave & Roosevelt Rd</option>
                        <option>Broadway & Sheridan Rd</option>
                        <option>Lincoln Ave & Waveland Ave</option>
                        <option>Logan Blvd & Elston Ave</option>
                        <option>California Ave & Francis Pl</option>
                        <option>Kedzie Ave & Milwaukee Ave</option>
                        <option>Hermitage Ave & Polk St</option>
                        <option>Halsted St & 37th St</option>
                        <option>Rhodes Ave & 32nd St</option>
                        <option>Stetson Ave & South Water St</option>
                        <option>Cottage Grove Ave & Oakwood Blvd</option>
                        <option>Lake Park Ave & 47th St</option>
                        <option>Lake Shore Dr & North Blvd</option>
                        <option>Cottage Grove Ave & 43rd St</option>
                        <option>Indiana Ave & 31st St</option>
                        <option>Michigan Ave & 18th St</option>
                        <option>Racine Ave & 15th St</option>
                        <option>Ashland Ave & 13th St</option>
                        <option>California Ave & North Ave</option>
                        <option>Ashland Ave & Grand Ave</option>
                        <option>Wallace Ave & 35th St</option>
                        <option>Halsted St & 35th St</option>
                        <option>Morgan St & 31st St</option>
                        <option>Western Ave & 24th St</option>
                        <option>Halsted St & Maxwell St</option>
                        <option>LaSalle St & Jackson Blvd</option>
                        <option>Michigan Ave & Jackson Blvd</option>
                        <option>Wood St & Grand Ave</option>
                        <option>Franklin St & Quincy St</option>
                        <option>Franklin St & Arcade Pl</option>
                        <option>Larrabee St & Armitage Ave</option>
                        <option>Wells St & Concord Ln</option>
                        <option>Kedzie Ave & Palmer Ct</option>
                        <option>Wells St & Evergreen Ave</option>
                        <option>Southport Ave & Clark St</option>
                        <option>Broadway & Wilson Ave</option>
                        <option>Broadway & Berwyn Ave</option>
                        <option>Broadway & Argyle St</option>
                        <option>Broadway & Belmont Ave</option>
                        <option>Paulina St & Montrose Ave</option>
                        <option>Lincoln Ave & Belle Plaine Ave</option>
                        <option>Halsted St & Roscoe St</option>
                        <option>Broadway & Barry Ave</option>
                        <option>Clark St & Schiller St</option>
                        <option>Sheffield Ave & Wrightwood Ave</option>
                        <option>Broadway & Cornelia Ave</option>
                        <option>Halsted St & Waveland Ave</option>
                        <option>Western Ave & Division St</option>
                        <option>Sheridan Rd & Buena Ave</option>
                        <option>Southport Ave & Clybourn Ave</option>
                        <option>Seeley Ave & Roscoe St</option>
                        <option>Leavitt St & Armitage Ave</option>
                        <option>Damen Ave & Charleston St</option>
                        <option>Lincoln Ave & Eastwood Ave</option>
                        <option>Clarendon Ave & Gordon Ter</option>
                        <option>Lakeview Ave & Fullerton Pkwy</option>
                        <option>Ravenswood Ave & Berteau Ave</option>
                        <option>Leavitt St & Hirsch St</option>
                        <option>Damen Ave & Sunnyside Ave</option>
                        <option>Wood St & Taylor St </option>
                        <option>Southport Ave & Irving Park Rd</option>
                        <option>Greenview Ave & Diversey Pkwy</option>
                        <option>Loomis St & Lexington St</option>
                        <option>Wabash Ave & 8th St</option>
                        <option>Kimbark Ave & 53rd St</option>
                        <option>Sheridan Rd & Lawrence Ave</option>
                        <option>Stockton Dr & Wrightwood Ave</option>
                        <option>Clark St & Winnemac Ave</option>
                        <option>Clark St & Leland Ave</option>
                        <option>Sheffield Ave & Webster Ave</option>
                        <option>Ellis Ave & 58th St</option>
                        <option>Lake Shore Dr & Diversey Pkwy</option>
                        <option>Lincoln Ave & Addison St</option>
                        <option>Halsted St & Blackhawk St</option>
                        <option>Halsted St & Diversey Pkwy</option>
                        <option>Ashland Ave & Blackhawk St</option>
                        <option>Lake Shore Dr & Belmont Ave</option>
                        <option>Calumet Ave & 35th St</option>
                        <option>Cottage Grove Ave & 47th St</option>
                        <option>Clark St & Chicago Ave</option>
                        <option>Calumet Ave & 18th St</option>
                        <option>Emerald Ave & 31st St</option>
                        <option>Clark St & Wrightwood Ave</option>
                        <option>Adler Planetarium</option>
                        <option>Wolcott Ave & Polk St</option>
                        <option>Racine Ave & Wrightwood Ave</option>
                        <option>Wolcott Ave & Lawrence Ave</option>
                        <option>Lake Park Ave & 56th St</option>
                        <option>Ada St & Washington Blvd</option>
                        <option>Ashland Ave & Grace St</option>
                        <option>California Ave & 21st St</option>
                        <option>Halsted St & Wrightwood Ave</option>
                        <option>Ashland Ave & Chicago Ave</option>
                        <option>Cottage Grove Ave & 51st St</option>
                    </select>

                    <select id="rightValues2" name ="Communities" size ="4" multiple>
                        <option>The Loop</option>
                        <option>Lincoln Park</option>
                        <option>Lower West Side</option>
                        <option>West Town</option>
                        <option>Near West Side</option>
                        <option>Near North Side</option>
                        <option>Near South Side</option>
                        <option>Logan Square</option>
                        <option>Lake View</option>
                        <option>Armour Square</option>
                        <option>Hyde Park</option>
                        <option>Douglas</option>
                        <option>North Center</option>
                        <option>Grand Boulevard</option>
                        <option>Chicago Loop</option>
                        <option>Washington Park</option>
                        <option>Bridgeport</option>
                        <option>Uptown</option>
                        <option>Lincoln Square</option>
                        <option>Kenwood</option>
                        <option>O'Hare</option>
                        <option>Oakland</option>
                        <option>Edge Water</option>
                        <option>South Lawndale</option>
                    </select>
                </div>
            </section>
            <script>
            
                function initDropDownChangeHandler (){
                 
                    var element = document.getElementById("Chicago_Data");

                    element.onchange = updateDropDownTarget;
                    element.onchange();
                }

                function updateDropDownTarget(){
                    //document.getElementById('LEFTDIV').innerHTML = " ";
                    var id = this.options[this.selectedIndex].value;   
                    // comm/district
                    //console.log("id--" + id);

                    var getTag = this.parentNode.getElementsByTagName("select");
                    // HTML Object

                    //console.log("getTag " + getTag);
                    var length = getTag.length;
                    //length of the object

                    console.log("length" + length);

                    for (var indx = length - 1; indx > 0; --indx) {

                    //console.log("Class -- " + getTag[indx].name);
                        if (getTag[indx].name == id)  {
                            getTag[indx].style.display = "inline";
                        }   
                        else {
                            getTag[indx].style.display = "none";
                        }    
                    }
                    var e1 = document.getElementById("Chicago_Data");
                    var e2 = e1.options[e1.selectedIndex].text;

                if (e2 == "Stations"){
                        
                        //$('#rightValues2 option').remove();

                        $("#btnLeft").click(function () {

                            var selectedItem = $("#rightValues1 option:selected");
                            $("#leftValues1").append(selectedItem);
                        });

                        $("#btnRight").click(function () {
                            var selectedItem = $("#leftValues1 option:selected");
                            $("#rightValues1").append(selectedItem);
                            
                        });

                        //sorting the list alphabetically
                        $("#btnRight").click(function(){
                            $("#rightValues1").html($("#rightValues1 option").sort(function (first, second) {
                                return first.text == second.text ? 0 : first.text < second.text ? -1 : 1
                            }));
                        });

                        /*
                        $("#rightValues1").change(function () {
                            var selectedItem = $("#rightValues1 option:selected");
                            $("#txtRight").val(selectedItem.text());
                        });
                        */

                }
                else if (e2 == "Communities"){
                    //$('#rightValues2').html(backup2);
                    //$('#rightValues1 option').remove();
                    $("#btnLeft").click(function () {

                        var selectedItem = $("#rightValues2 option:selected");

                        $("#leftValues2").append(selectedItem);
                    });

                    $("#btnRight").click(function () {
                        var selectedItem = $("#leftValues2 option:selected");
                        $("#rightValues2").append(selectedItem);
                        
                    });

                    //sorting the list alphabetically
                    $("#btnRight").click(function(){
                        $("#rightValues2").html($("#rightValues2 option").sort(function (first, second) {
                            return first.text == second.text ? 0 : first.text < second.text ? -1 : 1
                        }));
                    });

                    /*$("#rightValues2").change(function () {
                        var selectedItem = $("#rightValues2 option:selected");
                        $("#txtRight").val(selectedItem.text());
                    });
                    */

                }

                }

                window.onload = initDropDownChangeHandler;
            </script>
            <script type="text/javascript">
                //jQuery to select stations from a list
                
                var userTime = new Date('6/28/2013  11:02:00 AM');
                console.log(userTime);
            </script>
        </div>
</body>
</html>
